% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bocpd.R
\name{bocpd_changepoints}
\alias{bocpd_changepoints}
\title{Estimate changepoint locations from BOCPD output}
\usage{
bocpd_changepoints(
  fit,
  method = c("cp_prob", "map_drop"),
  threshold = NULL,
  min_sep = 1L
)
}
\arguments{
\item{fit}{Output from \code{\link{bocpd}} (a list with element \code{rl}),
or a list with element \code{rl_matrix}.}

\item{method}{Character; one of \code{"cp_prob"} or \code{"map_drop"}.}

\item{threshold}{Numeric threshold. Interpretation depends on \code{method}:
\itemize{
\item \code{"cp_prob"}: probability in \eqn{[0,1]} (default \code{0.5}).
\item \code{"map_drop"}: non-negative drop in MAP run length (default \code{10}).
}}

\item{min_sep}{Integer; minimum separation (in time points) between returned
changepoints. When multiple candidates occur within \code{min_sep}, the
strongest one (largest score) is kept. Default is \code{1} (no filtering).}
}
\value{
Integer vector of time indices (1-based) flagged as changepoints.
}
\description{
Provides simple changepoint extraction heuristics from the run-length
posterior returned by \code{\link{bocpd}}. These heuristics are intended
for quick summarization of the posterior and do not modify the underlying
BOCPD recursion.
}
\details{
The changepoint selection heuristics implemented here are inspired by
the post-processing procedures described in Bretz (2021), which proposes
identifying changepoints either via elevated posterior mass at
\eqn{r_t = 0} or via sharp drops in the maximum a posteriori (MAP)
run length. These heuristics operate \emph{after} the BOCPD recursion and do
not alter the underlying Bayesian filtering algorithm of
Adams and MacKay (2007).

Two methods are available:
\itemize{
\item \code{"cp_prob"}: selects times where \eqn{P(r_t=0 \mid x_{1:t})}
exceeds \code{threshold}.
\item \code{"map_drop"}: selects times where the MAP run length decreases
by at least \code{threshold} compared to the previous time step.
}
}
\examples{
set.seed(1)
x <- c(rnorm(50, 0), rnorm(50, 3))
model <- gaussian_mean_model(mu0 = 0, kappa0 = 1, alpha0 = 1, beta0 = 1)
h <- hazard_constant(100)
fit <- bocpd(x, model, h, control = list(r_max = 200, prune_eps = 1e-12))
bocpd_changepoints(fit, method = "cp_prob", threshold = 0.3)

}
